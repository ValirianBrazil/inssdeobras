<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cálculo de Custo de Obra</title>
    <style>
        :root {
            --primary-color: #4a6baf;
            --secondary-color: #f8f9fa;
            --accent-color: #e9ecef;
            --border-color: #dee2e6;
            --text-color: #495057;
            --error-color: #dc3545;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--primary-color);
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(74, 107, 175, 0.2);
        }
        
        .row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px;
        }
        
        .col {
            flex: 1;
            padding: 0 10px;
            min-width: 200px;
        }
        
        .result-field {
            background-color: var(--secondary-color);
            padding: 12px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            font-weight: 500;
        }
        
        .required:after {
            content: " *";
            color: var(--error-color);
        }
        
        .divider {
            border-top: 1px solid var(--border-color);
            margin: 30px 0;
        }
        
        .section-title {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: 600;
            text-align: center;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background-color 0.3s;
            width: 100%;
            margin-top: 20px;
        }
        
        button:hover {
            background-color: #3a5a9f;
        }
        
        .error {
            color: var(--error-color);
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
        
        @media (max-width: 768px) {
            .col {
                flex: 100%;
                margin-bottom: 15px;
            }
            
            .row {
                margin: 0;
            }
        }
a {
  color: #4a6baf;           /* Cor normal do link */
  text-decoration: none; /* Remove o sublinhado */
  font-weight: normal;     /* Deixa o texto em negrito */
}

a:hover {
  color: red;            /* Cor ao passar o mouse */
  text-decoration: none;
}

a:visited {
  color: purple;         /* Cor depois que o link foi clicado */
}

a:active {
  color: orange;         /* Cor enquanto o link está sendo clicado */
}
    </style>
</head>
<body>
    <div class="container">
        <h1>Calculadora de INSS de OBRA (beta)</h1>
        
        <form id="costCalculationForm">
            <div class="form-group">
                <label for="destination" class="required">Destinação</label>
                <select id="destination" required>
                    <option value="">Selecione uma opção</option>
                    <option value="Unifamiliar">Unifamiliar</option>
                    <option value="Multfamiliar">Multfamiliar</option>
                    <option value="Comercial">Comercial Salas e Lojas</option>
                    <option value="Industrial">Galpão Industrial</option>
                    <option value="Conjunto">Conjunto Habitacional Popular</option>
                    <option value="CasaPopular">Casa Popular</option>
                </select>
                <div class="error" id="destinationError">Este campo é obrigatório</div>
            </div>
            
            <div class="form-group">
                <label for="builtArea" class="required">Área Construída (m²)</label>
                <input type="number" id="builtArea" required min="0" step="0.01">
                <div class="error" id="builtAreaError">Este campo é obrigatório e deve conter apenas números</div>
            </div>
            
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="coveredComplementaryArea">Área Construída Complementar (coberta m²)</label>
                        <input type="number" id="coveredComplementaryArea" min="0" step="0.01" value="0">
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="uncoveredComplementaryArea">Área Construída Complementar (descoberta m²)</label>
                        <input type="number" id="uncoveredComplementaryArea" min="0" step="0.01" value="0">
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="totalBuiltArea">Área Construída Total (m²)</label>
                        <div class="result-field" id="totalBuiltArea">0</div>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="equivalencePercentage">Percentual de equivalência</label>
                        <div class="result-field" id="equivalencePercentage">0%</div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="equivalentArea">Área Equivalente</label>
                <div class="result-field" id="equivalentArea">0</div>
            </div>
            
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="vau" class="required">VAU (R$) | <a href="https://docs.google.com/spreadsheets/d/1PBZ_WarubufBurQA714oggFkLkXRtSN0Vzg_KfjdIFs/edit?usp=sharing" target="_blank">Consulte a tabela VAU atualizada</a>
</label>
                        <input type="text" id="vau" required>
                        <div class="error" id="vauError">Este campo é obrigatório</div>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="constructionCost">Custo de Obra por Destinação (R$)</label>
                        <div class="result-field" id="constructionCost">R$ 0,00</div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="state" class="required">Estado</label>
                        <select id="state" required>
                            <option value="">Selecione um estado</option>
                            <option value="AC">AC</option>
                            <option value="AL">AL</option>
                            <option value="AP">AP</option>
                            <option value="AM">AM</option>
                            <option value="BA">BA</option>
                            <option value="CE">CE</option>
                            <option value="DF">DF</option>
                            <option value="ES">ES</option>
                            <option value="GO">GO</option>
                            <option value="MA">MA</option>
                            <option value="MT">MT</option>
                            <option value="MS">MS</option>
                            <option value="MG">MG</option>
                            <option value="PA">PA</option>
                            <option value="PB">PB</option>
                            <option value="PR">PR</option>
                            <option value="PE">PE</option>
                            <option value="PI">PI</option>
                            <option value="RJ">RJ</option>
                            <option value="RN">RN</option>
                            <option value="RS">RS</option>
                            <option value="RO">RO</option>
                            <option value="RR">RR</option>
                            <option value="SC">SC</option>
                            <option value="SP">SP</option>
                            <option value="SE">SE</option>
                            <option value="TO">TO</option>
                        </select>
                        <div class="error" id="stateError">Este campo é obrigatório</div>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="concreteUsed" class="required">Foi utilizado concreto usinado?</label>
                        <select id="concreteUsed" required>
                            <option value="">Selecione uma opção</option>
                            <option value="sim">Sim</option>
                            <option value="nao">Não</option>
                        </select>
                        <div class="error" id="concreteError">Este campo é obrigatório</div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="concreteDiscount">Abatimento por uso de concreto usinado (R$)</label>
                        <div class="result-field" id="concreteDiscount">R$ 0,00</div>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="socialFactor">Fator Social</label>
                        <div class="result-field" id="socialFactor">0%</div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="totalLaborRemuneration">Remuneração de Mão de Obra Total - RMT (R$)</label>
                <div class="result-field" id="totalLaborRemuneration">R$ 0,00</div>
            </div>
            
            <div class="form-group">
                <label for="calculationBase">Base de Cálculo, RMT (R$)</label>
                <div class="result-field" id="calculationBase">R$ 0,00</div>
		<label for="calculationBase">Este é o valor que a RECEITA FEDERAL irá cobrar sem o FATOR DE AJUSTE (R$)</label>
            </div>
            
            <div class="divider"></div>
            
            <h3 class="section-title">- Aplicação do Fator de Ajuste -</h3>
            
            <div class="form-group">
                <label for="adjustmentFactor">Fator de Ajuste</label>
                <div class="result-field" id="adjustmentFactor">0%</div>
            </div>
            
            <div class="form-group">
                <label for="rmtForFa">RMT para o FA (R$)</label>
                <div class="result-field" id="rmtForFa">R$ 0,00</div>
            </div>
            
            <div class="form-group">
                <label for="cpp">Contribuição Patronal Previdenciária - CPP (R$)</label>
                <div class="result-field" id="cpp">R$ 0,00</div>
		<label for="cpp">Este é o valor devido após a aplicação do FATOR DE AJUSTE</label>
            </div>
            
            
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Mapeamento dos percentuais por estado e destinação
            const discountMap = {
                'AC': { Unifamiliar: 7.43, Multfamiliar: 9.61, Conjunto: 4.69, Comercial: 13.33, Industrial: 4.52, CasaPopular: 4.69 },
                'AL': { Unifamiliar: 6.11, Multfamiliar: 8.12, Conjunto: 3.98, Comercial: 11.35, Industrial: 3.82, CasaPopular: 3.98 },
                'AM': { Unifamiliar: 7.43, Multfamiliar: 9.61, Conjunto: 4.69, Comercial: 13.33, Industrial: 4.52, CasaPopular: 4.69 },
                'AP': { Unifamiliar: 7.48, Multfamiliar: 9.41, Conjunto: 4.88, Comercial: 12.93, Industrial: 4.38, CasaPopular: 4.88 },
                'BA': { Unifamiliar: 5.53, Multfamiliar: 7.46, Conjunto: 3.73, Comercial: 10.31, Industrial: 3.62, CasaPopular: 3.73 },
                'CE': { Unifamiliar: 5.72, Multfamiliar: 7.69, Conjunto: 3.70, Comercial: 10.69, Industrial: 3.44, CasaPopular: 3.70 },
                'DF': { Unifamiliar: 5.24, Multfamiliar: 7.06, Conjunto: 3.53, Comercial: 9.62, Industrial: 3.43, CasaPopular: 3.53 },
                'ES': { Unifamiliar: 5.15, Multfamiliar: 6.85, Conjunto: 3.33, Comercial: 9.45, Industrial: 3.26, CasaPopular: 3.33 },
                'GO': { Unifamiliar: 5.79, Multfamiliar: 7.62, Conjunto: 3.88, Comercial: 10.27, Industrial: 3.60, CasaPopular: 3.88 },
                'MA': { Unifamiliar: 6.94, Multfamiliar: 8.73, Conjunto: 4.18, Comercial: 12.06, Industrial: 4.07, CasaPopular: 4.18 },
                'MG': { Unifamiliar: 4.68, Multfamiliar: 6.22, Conjunto: 3.15, Comercial: 8.66, Industrial: 3.05, CasaPopular: 3.15 },
                'MS': { Unifamiliar: 6.74, Multfamiliar: 8.74, Conjunto: 4.34, Comercial: 12.20, Industrial: 4.28, CasaPopular: 4.34 },
                'MT': { Unifamiliar: 6.22, Multfamiliar: 8.01, Conjunto: 4.02, Comercial: 10.96, Industrial: 3.89, CasaPopular: 4.02 },
                'PA': { Unifamiliar: 7.58, Multfamiliar: 9.77, Conjunto: 4.91, Comercial: 13.48, Industrial: 4.45, CasaPopular: 4.91 },
                'PB': { Unifamiliar: 6.32, Multfamiliar: 8.58, Conjunto: 4.12, Comercial: 11.81, Industrial: 3.81, CasaPopular: 4.12 },
                'PE': { Unifamiliar: 5.12, Multfamiliar: 6.89, Conjunto: 3.51, Comercial: 9.74, Industrial: 3.42, CasaPopular: 3.51 },
                'PI': { Unifamiliar: 5.33, Multfamiliar: 7.16, Conjunto: 3.53, Comercial: 10.00, Industrial: 3.30, CasaPopular: 3.53 },
                'PR': { Unifamiliar: 4.91, Multfamiliar: 6.50, Conjunto: 3.18, Comercial: 8.78, Industrial: 3.08, CasaPopular: 3.18 },
                'RJ': { Unifamiliar: 4.94, Multfamiliar: 6.52, Conjunto: 3.20, Comercial: 9.02, Industrial: 3.08, CasaPopular: 3.20 },
                'RN': { Unifamiliar: 5.96, Multfamiliar: 7.62, Conjunto: 4.01, Comercial: 10.41, Industrial: 3.63, CasaPopular: 4.01 },
                'RO': { Unifamiliar: 6.22, Multfamiliar: 8.01, Conjunto: 4.02, Comercial: 10.96, Industrial: 3.89, CasaPopular: 4.02 },
                'RR': { Unifamiliar: 7.43, Multfamiliar: 9.61, Conjunto: 4.69, Comercial: 13.33, Industrial: 4.52, CasaPopular: 4.69 },
                'RS': { Unifamiliar: 5.01, Multfamiliar: 6.54, Conjunto: 3.25, Comercial: 8.77, Industrial: 3.23, CasaPopular: 3.25 },
                'SC': { Unifamiliar: 4.79, Multfamiliar: 6.19, Conjunto: 2.93, Comercial: 8.36, Industrial: 2.87, CasaPopular: 2.93 },
                'SE': { Unifamiliar: 6.97, Multfamiliar: 9.05, Conjunto: 4.34, Comercial: 12.50, Industrial: 4.18, CasaPopular: 4.34 },
                'SP': { Unifamiliar: 4.90, Multfamiliar: 6.35, Conjunto: 3.15, Comercial: 8.69, Industrial: 2.96, CasaPopular: 3.15 },
                'TO': { Unifamiliar: 5.33, Multfamiliar: 7.16, Conjunto: 3.53, Comercial: 10.00, Industrial: 3.30, CasaPopular: 3.53 }
            };
            
            // Formatador de moeda
            const formatter = new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            });
            
            // Formatador de porcentagem
            const percentFormatter = new Intl.NumberFormat('pt-BR', {
                style: 'percent',
                minimumFractionDigits: 2
            });
            
            // Formatador de números
            const numberFormatter = new Intl.NumberFormat('pt-BR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
            
            // Elementos do formulário
            const form = document.getElementById('costCalculationForm');
            const destination = document.getElementById('destination');
            const builtArea = document.getElementById('builtArea');
            const coveredComplementaryArea = document.getElementById('coveredComplementaryArea');
            const uncoveredComplementaryArea = document.getElementById('uncoveredComplementaryArea');
            const totalBuiltArea = document.getElementById('totalBuiltArea');
            const equivalencePercentage = document.getElementById('equivalencePercentage');
            const equivalentArea = document.getElementById('equivalentArea');
            const vau = document.getElementById('vau');
            const constructionCost = document.getElementById('constructionCost');
            const state = document.getElementById('state');
            const concreteUsed = document.getElementById('concreteUsed');
            const concreteDiscount = document.getElementById('concreteDiscount');
            const socialFactor = document.getElementById('socialFactor');
            const totalLaborRemuneration = document.getElementById('totalLaborRemuneration');
            const calculationBase = document.getElementById('calculationBase');
            const adjustmentFactor = document.getElementById('adjustmentFactor');
            const rmtForFa = document.getElementById('rmtForFa');
            const cpp = document.getElementById('cpp');
            const email = document.getElementById('email');
            
            // Adiciona máscara de moeda ao campo VAU
            vau.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                value = (value / 100).toFixed(2);
                e.target.value = formatter.format(value).replace('R$', '').trim();
                calculateAll();
            });
            
            // Adiciona listeners para os campos que disparam cálculos
            const inputFields = [destination, builtArea, coveredComplementaryArea, uncoveredComplementaryArea, vau, state, concreteUsed];
            inputFields.forEach(field => {
                field.addEventListener('change', calculateAll);
            });
            
            // Função principal de cálculo
            function calculateAll() {
                // Calcula área total construída
                const builtAreaValue = parseFloat(builtArea.value) || 0;
                const coveredComplementaryValue = parseFloat(coveredComplementaryArea.value) || 0;
                const uncoveredComplementaryValue = parseFloat(uncoveredComplementaryArea.value) || 0;
                const totalArea = builtAreaValue + coveredComplementaryValue + uncoveredComplementaryValue;
                totalBuiltArea.textContent = numberFormatter.format(totalArea);
                
                // Calcula percentual de equivalência
                const destinationValue = destination.value;
                let percentage = 0;
                
                if (destinationValue === 'Unifamiliar') {
                    percentage = totalArea <= 1000 ? 0.89 : 0.85;
                } else if (destinationValue === 'Multfamiliar') {
                    percentage = totalArea <= 1000 ? 0.90 : 0.86;
                } else if (destinationValue === 'Comercial') {
                    percentage = totalArea <= 3000 ? 0.86 : 0.83;
                } else if (destinationValue === 'Industrial') {
                    percentage = 0.95;
                } else if (destinationValue === 'Conjunto' || destinationValue === 'CasaPopular') {
                    percentage = 0.98;
                }
                
                equivalencePercentage.textContent = percentFormatter.format(percentage);
                
                // Calcula área equivalente
                const equivalentAreaValue = totalArea * percentage;
                equivalentArea.textContent = numberFormatter.format(equivalentAreaValue);
                
                // Calcula custo de obra
                const vauValue = parseFloat(vau.value.replace(/\D/g, '')) / 100 || 0;
                const constructionCostValue = equivalentAreaValue * vauValue;
                constructionCost.textContent = formatter.format(constructionCostValue);
                
                // Calcula abatimento por concreto usinado
                const stateValue = state.value;
                const concreteUsedValue = concreteUsed.value;
                let discountPercentage = 0;
                
                if (concreteUsedValue === 'sim' && stateValue && destinationValue && discountMap[stateValue]) {
                    discountPercentage = discountMap[stateValue][destinationValue] / 100;
                }
                
                const discountValue = constructionCostValue * 0.05 * discountPercentage;
                concreteDiscount.textContent = formatter.format(discountValue);
                
                // Calcula fator social
                let socialFactorPercentage = 0;
                if (totalArea < 100) {
                    socialFactorPercentage = 0.20;
                } else if (totalArea <= 200) {
                    socialFactorPercentage = 0.40;
                } else if (totalArea <= 300) {
                    socialFactorPercentage = 0.55;
                } else if (totalArea <= 400) {
                    socialFactorPercentage = 0.70;
                } else {
                    socialFactorPercentage = 0.90;
                }
                
                socialFactor.textContent = percentFormatter.format(socialFactorPercentage);
                
                // Calcula remuneração total de mão de obra
                const laborRemuneration = constructionCostValue * socialFactorPercentage * 0.2 - discountValue;
                totalLaborRemuneration.textContent = formatter.format(laborRemuneration);
                
                // Calcula base de cálculo
                const calculationBaseValue = laborRemuneration * 0.368;
                calculationBase.textContent = formatter.format(calculationBaseValue);
                
                // Calcula fator de ajuste
                const adjustmentFactorPercentage = totalArea < 350 ? 0.5 : 0.7;
                adjustmentFactor.textContent = percentFormatter.format(adjustmentFactorPercentage);
                
                // Calcula RMT para FA
                const rmtForFaValue = laborRemuneration * adjustmentFactorPercentage;
                rmtForFa.textContent = formatter.format(rmtForFaValue);
                
                // Calcula CPP
                const cppValue = rmtForFaValue * 0.2;
                cpp.textContent = formatter.format(cppValue);
            }
            
            // Validação do formulário
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                let isValid = true;
                
                // Validação do campo Destinação
                if (!destination.value) {
                    document.getElementById('destinationError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('destinationError').style.display = 'none';
                }
                
                // Validação do campo Área Construída
                if (!builtArea.value || isNaN(builtArea.value)) {
                    document.getElementById('builtAreaError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('builtAreaError').style.display = 'none';
                }
                
                // Validação do campo VAU
                if (!vau.value) {
                    document.getElementById('vauError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('vauError').style.display = 'none';
                }
                
                // Validação do campo Estado
                if (!state.value) {
                    document.getElementById('stateError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('stateError').style.display = 'none';
                }
                
                // Validação do campo Concreto Usinado
                if (!concreteUsed.value) {
                    document.getElementById('concreteError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('concreteError').style.display = 'none';
                }
                
                if (isValid) {
                    // Aqui você pode adicionar a lógica para enviar o formulário
                    alert('Formulário enviado com sucesso!');
                    
                    // Se o e-mail foi preenchido, enviar o resumo
                    if (email.value) {
                        sendEmailSummary();
                    }
                }
            });
            
            // Função para enviar resumo por e-mail (simulado)
            function sendEmailSummary() {
                // Em uma implementação real, isso seria uma chamada AJAX para o servidor
                console.log('Enviando resumo para:', email.value);
                
                const summary = `
                    Resumo do Cálculo de Custo de Obra:
                    
                    Destinação: ${destination.options[destination.selectedIndex].text}
                    Área Construída Total: ${totalBuiltArea.textContent} m²
                    Área Equivalente: ${equivalentArea.textContent} m²
                    Custo de Obra por Destinação: ${constructionCost.textContent}
                    Abatimento por concreto usinado: ${concreteDiscount.textContent}
                    Remuneração de Mão de Obra Total: ${totalLaborRemuneration.textContent}
                    Base de Cálculo: ${calculationBase.textContent}
                    CPP: ${cpp.textContent}
                `;
                
                console.log(summary);
                alert(`Um resumo foi enviado para ${email.value}`);
            }
            
            // Calcula tudo ao carregar a página para inicializar os valores
            calculateAll();
        });
    </script>
</body>
</html>